# 第 9 章  数据库技术基础

数据库技术是研究数据库的结构、存储、设计、管理和应用的一门软件学科。

数据库系统本质上是一个用计算机存储信息的系统。

数据库管理系统是位于用户与操作系统之间的一层数 据管理软件，其基本目标是提供一个可以方便、有效地存取数据库信息的环境。

数据库就是信 息的集合，它是收集计算机数据的仓库或容器，系统用户可以对这些数据执行一系列操作。

设计数据库系统的目的是为了管理大量信息，给用户提供数据的抽象视图，即系统隐藏有关数据 存储和维护的某些细节。对数据的管理涉及信息存储结构的定义、信息操作机制的提供、安全 性保证，以及多用户对数据的共享问题。

## 9.1 基本概念

### 9.1.1 数据库与数据库系统

数据是描述事物的符号记录，它具有多种表现形式，可以是文字、图形、图像、声音和语言等。

信息是现实世界事物的存在方式或状态的反映。信息具有可感知、可存储、可加工、可 传递和可再生等自然属性，信息己是社会各行各业不可缺少的资源，这也是信息的社会属性。 数据是信息的符号表示，而信息是具有特定释义和意义的数据。

数据库系统(DataBase System, DBS)是一个采用了数据库技术，有组织地、动态地存储 大量相关数据，方便多用户访问的计算机系统。广义上讲，DBS是由数据库、硬件、软件和人 员组成的。

#### (1)数据库(DataBase, DB)

数据库是统一管理的、长期储存在计算机内的、有组织的 相关数据的集合。其特点是数据间联系密切、冗余度小、独立性较高、易扩展，并且可为各类 用户共享。

#### (2)硬件

硬件是构成计算机系统的各种物理设备，包括存储数据所需的外部设备。硬件 的配置应满足整个数据库系统的需要。

#### (3) 软件

软件包括操作系统、数据库管理系统及应用程序。

数据库管理系统简称DBMS, 它是数据库系统的核心软件，需要在操作系统的支持下工作，解决如何科学地组织和储存数据， 如何高效地获取和维护数据。其主要功能包括数据定义功能、数据操纵功能、数据库的运行管理和数据库的建立与维护。

#### (4)人员

人员主要有4类

第一类为系统分析员和数据库设计人员，系统分析员负责应用系统的需求分析和规范说明，他们和用户及数据库管理员一起确定系统的硬件配置，并参与 数据库系统的概要设计;数据库设计人员负责数据库中数据的确定、数据库各级模式的设计。

第二类为应用程序员，负责编写使用数据库的应用程序，这些应用程序可对数据进行检索、建立、删除或修改。

第三类为最终用户，他们应用系统的接口或利用查询语言访问数据库。

第四 类用户是数据库管理员(Data Base Administrator, DBA),负责数据库的总体信息控制。DBA 的具体职责包括决定数据库中的信息内容和结构;决定数据库的存储结构和存取策略;定义数 据库的安全性要求和完整性约束条件;监控数据库的使用和运行;改进数据库的性能;重组和 重构数据库，以提高系统的性能。

### 9.1.2 数据库管理系统的功能

数据库管理系统(DataBase Management System, DBMS)主要实现对共享数据有效地组织、管理和存取，故DBMS应具有以下六个方面的功能。

#### 1.数据定义

DBMS提供数据定义语言(Data Definition Language, DDL),用户可以对数据库的结构进 行描述，包括外模式、模式和内模式的定义;数据库的完整性定义;安全保密定义，如口令、 级别和存取权限等。这些定义存储在数据字典中，是DBMS运行的基本依据。

#### 2.数据库操作

DBMS向用户提供数据操纵语言(Data Manipulation Language, DML)，实现对数据库中 数据的基本操作，例如检索、插入、修改和删除。DML分为两类，即宿主型和自含型。所谓宿 主型是指将DML语句嵌入某种主语言(如C、COBOL等)中使用;自含型是指可以单独使用 DML语句，供用户交互使用。

#### 3.数据库运行管理

数据库在运行期间多用户环境下的并发控制、安全性检査和存取控制、完整性检查和执行、 运行日志的组织管理、事务管理和自动恢复等是DBMS的重要组成部分，这些功能可以保证数 据库系统的正常运行。

#### 4.数据的组织、存储和管理

DBMS分类组织、存储和管理各种数据，包括数据字典、用户数据和存取路径等。因此要确定以何种文件结构和存取方式在存储级上组织这些数据，以提高存取效率。实现数据间的联 系、数据组织和存储的基本目标是提高存储空间的利用率。

#### 5.数据库的建立和维护

数据库的建立和维护包括数据库的初始建立、数据的转换、数据库的转储和恢复、数据库 的重组和重构、性能监测和分析等。

#### 6.其他功能

其他功能包括:DBMS的网络通信功能，一个DBMS与另一个DBMAS或文件系统的数 据转换功能，异构数据库之间的互访和互操作能力等。

### 9.1.3 数据库管理系统的特征及分类

#### 1.**DBMS**的特征

##### (1)数据结构化且统一管理

##### (2) 有较高的数据独立性

##### (3) 数据控制功能

DBMS提供了数据控制功能，以适应共享数据的环境。数据控制功能 包括对数据库中数据的安全性、完整性、并发和恢复的控制。

1. 数据库的安全性
2. 数据的完整性
3. 并发控制
4. 故障恢复。数据库中的4类故障是事务内部故障、系统故障、介质故障及计算机病毒。

#### 2.**DBMS**的分类

DBMS通常可分为以下三类。

##### (1)关系数据库系统(Relation DataBase Systems，RDBS)。

##### (2)面向对象的数据库系统(Object-Oriented DataBase System, OODBS)。

##### (3)对象关系数据库系统(Object-Oriented Relation DataBase System, ORDBS)。

### 9.1.4 数据库系统的体系结构

#### 1.集中式数据库系统

#### 2.客户端/服务器结构

数据库服务器一般可分为事务服务器和数据服务器。

##### (1)事务服务器

事务服务器也称查询服务器。它提供一个接口，使得客户端可以发出执 行一个动作的请求，服务器响应客户端请求，并将执行结果返回给客户端。

用户端可以用SQL,也可以通过应用程序或使用远程过程调用机制来表达请求。

##### (2)数据服务器

数据服务器系统使得客户端可以与服务器交互，以文件或页面为单位对 数据进行读取或更新。数据服务器与文件服务器相比提供更强的功能，所支持的数据单位可以 比文件还要小，如页、元组或对象;提供数据的索引机制和事务机制，使得客户端或进程发生故障时数据也不会处于不一致状态。

#### 3.并行数据库系统

并行体系结构的数据库系统是多个物理上连在一起的CPU,而分布式系统是多个地理上分 开的CPU。并行体系结构的数据库类型分为共享内存式多处理器和无共享式并行体系结构。

1)共享内存式多处理器

2)无共享式并行体系结构

#### 4.分布式数据库系统

分布式DBMS包括物理上分布、逻辑上集中的分布式数据库结构和物理上分布、逻辑上 分布的分布式数据库结构两种。

### 9.1.5数据库的三级模式结构

#### 1.概念模式

概念模式也称模式，它是数据库中全部数据的逻辑结构和特征的描述，由若干个概念记录 类型组成，只涉及型的描述，不涉及具体的值。

#### 2.外模式

外模式也称用户模式或子模式，是用户与数据库系统的接口，是用户用到的那部分数据的描述。

#### 3.内模式

内模式也称存储模式，是数据物理结构和存储方式的描述，是数据在数据库内部的表示方 式，定义所有的内部记录类型、索引和文件的组织方式，以及数据控制方面的细节。

#### 4.两级映像

数据库系统在三级模式之间提供了两级映像:模式/内模式映像、外模式/模式映像。

### 9.1.6 大数据

#### 1.大数据产生的背景

大数据(Big Data)是指“无法用现有的软件工具提取、存储、搜索、共享、分析和处理 的海量的、复杂的数据集合”。大数据产生的背景主要有以下4 个方面。

##### (1) 数据来源和承载方式的变革。

##### (2) 全球数据量出现爆炸式增长。

##### (3) 大数据已经成为一种自然资源。

##### (4)大数据日益重要，不被利用就是成本。

#### 2.大数据的特征

业界通常用 “4V”来概括大数据的特征。

##### 大量化(Volume)指数据体量巨大。

##### 多样化(Variety)指数据类型繁多。

##### 价值密度低(Value)指大量的不相关信息导致价值密度的高低与数据总量的大小成反比。

##### 快速化(Velocity)指处理速度快。

#### 3.理解大数据

大数据不仅仅是指海量的信息,更强调人类对信息的筛选、处理，保留有价值的信息，即 让大数据更有意义，挖掘其潜在的“大价值”这才是对大数据的正确理解。为此，有许多问题 需要研究与解决。

(1)高并发数据存取的性能要求及数据存储的横向扩展问题。目前，多从架构和并行等方面考虑解决。

(2)实现大数据资源化、知识化、普适化的问题，解决这些问题的关键是对非结构化数据的内容理解。 

(3)非结构化海量信息的智能化处理问题，主要解决自然语言理解、多媒体内容理解、机器学习等问题。 

大数据时代主要面临三大挑战:软件和数据处理能力、资源和共享管理以及数据处理的可信力。

#### 4.大数据产生的安全风险

##### (1)大数据成为网络攻击的显著目标。

##### (2) 大数据加大了隐私泄露风险。

##### (3)大数据威胁现有的存储和安防措施。

##### (4)大数据技术成为黑客的攻击手段。

##### (5)大数据成为高级可持续攻击的载体。

##### (6) 大数据技术为信息安全提供新支撑。

## 9.2 数据模型

### 9.2.1 基本概念

模型就是对现实世界特征的模拟和抽象，数据模型是对现实世界数据特征的抽象。

最常用的数据模型分为概念数据模型和基本数据模型。

#### 1.概念数据模型

概念数据模型也称信息模型，是按用户的观点对数据和信息建模。

是现实世界到信息世界的第一层抽象，强调其语义表达功能，易于用户理解。

是用户和数据库设计人员交流的语言，主要用于数据库设计。

这类模型中最著名的是实体•联系模型，简称E-R模型。

#### 2.基本数据模型

它是按计算机系统的观点对数据建模，是现实世界数据特征的抽象， 用于DBMS的实现。基本的数据模型有层次模型、网状模型、关系模型和面向对象模型(Object Oriented Model)。

### 9.2.2 数据模型的三要素

数据库结构的基础是数据模型，是用来描述数据的一组概念和定义。数据模型的三要素是 数据结构、数据操作和数据的约束条件。

#### 1.数据结构

数据结构是所研究的对象类型的集合，是对系统静态特性的描述。

#### 2. 数据操作

数据操作是对数据库中各种对象(型)的实例(值)允许执行的操作的集 合，包括操作及操作规则。例如操作有检索、插入、删除和修改，操作规则有优先级别等。数 据操作是对系统动态特性的描述。

#### 3.数据的约束条件

数据的约束条件是一组完整性规则的集合。

也就是说，对于具体的 应用数据必须遵循特定的语义约束条件，以保证数据的正确、有效和相容。

### 9.2.3 E-R模型

概念模型是对信息世界建模，所以概念模型能够方便、准确地表示信息世界中的常用概念。

该方法用E-R图来描述现实世界的概念模型，称为实体-联系 模型(Entity-Relationship Model，E-R 模型)。

在解决实际应用问题时，通常先设计一个E-R模型，然后再把其转换成计算机能接受的数据模型。

#### 1.实体

在 E-R 模型中，实体用矩形表示，通常矩形框内写明实体名。

实体是现实世界中可以区别于其他对象的“事件”或 “物体”。

例如，企业中的每个人都是一个实体。每个实体由一组特性 (属性)来表示，其中的某一部分属性可以唯一标识实体，例如职工实体集中的职工号。实体集是具有相同属性的实体集合。例如，学校的所有教师具有相同的属性，因此教师的集合可 以定义为一个实体集;学生具有相同的属性，因此学生的集合可以定义为另一个实体集。

#### 2.联系

在 E-R 模型中，联系用菱形表示，通常菱形框内写明联系名，并用无向边分别与有关实体连接起来，同时在无向边旁标注上联系的类型(1:1、1 : n或m : n)。

实体的联系分为实体内部的 联系和实体与实体之间的联系。实体内部的联系反映数据在同一记录内部各字段间的联系。

##### 1)两个不同实体之间的联系

两个不同实体集之间存在以下3种联系类型。

- 一对一(1 : 1)。指实体集在中的一个实体最多只与实体集尽中的一个实体相联系。
- 一对多(1 : n)。表示实体集五i中的一个实体可与实体集五2中的多个实体相联系。
- 多对多(m:n)。表示实体集五i中的多个实体可与实体集五2中的多个实体相联系

##### 2)两个以上不同实体集之间的联系

两个以上不同实体集之间存在1:1:1、1 : 1 : n、1 : m : n和r : m : n联系。

##### 3)同一实体集内的二元联系

同一实体集内的各实体之间也存在1:1、1 : n和m : n的联系

职工实体集中的领导与被领导的联系是1 的。

#### 3.属性

属性是实体某方面的特性。

例如，职工实体集具有职工号、姓名、年龄、参加工作时间和 通信地址等属性。

在同一实体集中，每个实体的属性及其 域是相同的，但可能取不同的值。

E-R 模型中的属性有以下分类。

##### (1)简单属性和复合属性。

简单属性是原子的、不可再分的，复合属性可以细分为更小的 部分(即划分为别的属性)。

有时用户希望访问整个属性，有时希望访问属性的某个成分，那 么在模式设计时可采用复合属性。例如，职工实体集的通信地址可以进一步分为邮编、省、市、 街道。若不特别声明，通常指的是简单属性。

##### (2)单值属性和多值属性。

在前面所举的例子中，定义的属性对于一个特定的实体都只有 单独的一个值。

例如，对于一个特定的职工，只对应一个职工号、职工姓名，这样的属性称为 单值属性。但是，在某些特定情况下，一个属性可能对应一组值。例如，职工可能有0 个、1 个或多个亲属，那么职工的亲属的姓名可能有多个数目，这样的属性称为多值属性。

##### (3) NULL属性。

当实体在某个属性上没有值或属性值未知时，使用NULL值，表示无意 义或不知道。

##### (4)派生属性。

派生属性可以从其他属性得来。

例如，职工实体集中有“参加工作时间” 和“工作年限”属性，那么“工作年限”的值可以由当前时间和参加工作时间得到。这里，“工 作年限”就是一个派生属性。

#### 4.实体-联系方法

概念模型中最常用的方法为实体-联系方法，简称E-R 方法。

该方法直接从现实世界中抽 象出实体和实体间的联系，然后用非常直观的E-R 图来表示数据模型。

![截屏2023-09-10 22.34.49](./assets/截屏2023-09-10 22.34.49.png)

#### 5.扩充的E-R模型

尽管基本的E-R模型足以对大多数数据库特征建模，但数据库某些情况下的特殊语义仅用 基本E-R模型无法表达清楚。在这一节中将讨论扩充的E-R模型，包括弱实体、特殊化、普遍 化等概念。

##### 1)弱实体

在现实世界中有一种特殊的联系，这种联系代表实体间的所有(Ownership) 关系，例如 职工与家属的联系，家属总是属于某职工的。

这种实体对于另一些实体具有很强的依赖关系，即一个实体的存在必须以另一个实体为前提，将这类实体称为弱实体。

![截屏2023-09-10 22.41.43](./assets/截屏2023-09-10 22.41.43.png)

##### 2)特殊化

但在现实世界中，某些实体一方面具 有一些共性，另一方面还具有各自的特殊性。这样，一个实体集可以按照某些特征区分为几个子实体。

例如，学生实体集可以分为研究生、本科生和大专生等子集。将这种从普遍到特殊的 过程称为“特殊化”。

将几个具有共同特性的实体集概括成一个更普遍的实体集的过程称为“普遍化”。

### 9.2.4 数据模型

在数据库领域中常见的数据模型有层次模型、网状模型、关系模型和面向对象模型。本章 重点介绍关系模型。

(1)层次模型(Hierarchical Model)釆用树型结构表示数据与数据间的联系。在层次模型 中，每一个结点表示一个记录类型(实体)，记录之间的联系用结点之间的连线表示，并且根 结点以外的其他结点有且仅有一个双亲结点。

(2)网状模型(Network Model)也称DBTG模型，该是一个比层次模型更具有普遍性的 数据结构，是层次模型的一个特例。网状模型可以直接地描述现实世界，因为去掉了层次模型 的两个限制，允许两个结点之间有多种联系(称之为复合联系)。

(3)关系模型(RelationalModel)是目前最常用的数据模型之一。关系数据库系统采用关 系模型作为数据的组织方式，在关系模型中用表格结构表达实体集以及实体集之间的联系，其 最大特色是描述的一致性。

(4)面向对象模型(Object Oriented Model)采用面向对象的方法来设计数据库。面向对象 的数据库存储对象是以对象为单位，每个对象包含对象的属性和方法，具有类和继承等特点。 Computer Associates的 Jasmine就是面向对象模型的数据库系统。

面向对象数据模型比网络、层次、关系数据模型具有更加丰富的表达能力。但正因为面向 对象模型的丰富表达能力，模型相对复杂，实现起来较困难。

### 9.2.5 关系模型

关系模型(Relation Model)是目前最常用的数据模型之一。

关系数据库系统采用关系模 型作为数据的组织方式，在关系模型中用表格结构表达实体集以及实体集之间的联系，其最大 特色是描述的一致性。

关系模型是由若干个关系模式组成的集合。一个关系模式相当于一个记 录型，对应于程序设计语言中类型定义的概念。关系是一个实例，也是一张表，对应于程序设 计语言中变量的概念。给定变量的值随时间可能发生变化，类似地，当关系被更新时，关系实 例的内容也随时间发生了变化。



## 9.3 关系代数

### 9.3.1 关系数据库的基本概念

#### 1.属性和域

在现实世界中，要描述一个事物常常取若干特征来表示，这些特征称为属性(Attribute)。例如，用学号、姓名、性别、系别、年龄和籍贯等属性来描述学生。每个属性的取值范围对应一个值的集合，称为该属性的域(Domain)。例如，学号的域是6位整型数;姓名的域是10位 字符;性别的域为{男，女}等。

在关系数据模型中，通常对域加了一个限制，所有的域都应是原子数据(Atomic Data)。

#### 2.笛卡儿积与关系

#### 3.关系的相关名词

(1)目或度(Degree)。这里的及表示关系的名字，《是关系的目或度。

(2) 候选码(Candidate Key)。若关系中的某一*属性或属性组的值能唯一地标识一个元组， 则称该属性或属性组为候选码。

(3)主码(PrimaryKey)。若一个关系有多个候选码，则选定其中一个为主码。

(4) 主属性(Non_Key attribute)。包含在任何候选码中的诸属性称为主属性。不包含在任 何候选码中的属性称为非码属性。

(5)外码(Foreign Key)。如果关系模式i?中的属性或属性组非该关系的码，但它是其他 关系的码，那么该属性集对关系模式i?而言是外码。

例如客户与贷款之间的借贷联系c-1 (c-id. loan-no),属性c-id是客户关系中的码，所以 c-id是外码;属性loan-no是贷款关系中的码，所以loan-no也是外码。

(6)全码(All-Key)。关系模型的所有属性组是这个关系模式的候选码，称为全码。

#### 4.关系的3种类型

(1) 基本关系。通常又称为基本表或基表，它是实际存在的表，是实际存储数据的逻辑 表。

(2)查询表。查询表是查询结果对应的表。

(3) 视图表。视图表是由基本表或其他视图表导出的表。由于它本身不独立存储在数据库 中，数据库中只存放它的定义，所以常称为虚表。

#### 5 . 关系数据库模式

在数据库中要区分型和值。

#### 6 . 完整性约束

#### 7.关系运算

### 9.3.2 5种基本的关系代数运算

5种基本的关系代数运算包括并、差、笛卡儿积、投影和选择，其他运算可以通过基本的关系运算导出。

#### 1.并(**Union**)



### 9.3.3 扩展的关系代数运算

扩展的关系代数运算可以从基本的关系运算中导出，主要包括选择、投影、连接、除法、 广义笛卡儿积和外连接。

#### 1.交 (Intersection)

#### 5.外连接(Outer Jion)

## 9.4 关系数据库SQL语言简介

SQL (Structured Query Language)，，它是关系数据库中最普遍使用的语言，包括数据查询(Query)、数据操纵(Manipulation)、 数据定义(Definition)和数据控制(Control)功能，是一种通用的、功能强大的关系数据库的 标准语言。

### 9.4.1 SQL 数据库体系结构

#### 1.**SQL**的特点

(1) 综合统一。

(2) 高度非过程化。

(3) 面向集合的操作方式。

(4) 两种使用方式。

(5)语言简洁、易学易用。

- 数据查询:SELECT。
- 数据定义:CREATE、DROP、ALTER。
- 数据操纵:INSERT、UPDATE、DELETE。
- 数据控制:GRANT、REVORK。

#### 2.**SQL**支持三级模式结构

SQL语言支持关系数据库的三级模式结构，其中，视图对应外模式、基本表对应模式、存储文件对应内模式。

![截屏2023-09-10 22.57.46](./assets/截屏2023-09-10 22.57.46.png)

### 9.4.2 SQL 的基本组成

1. 数据定义语言。 SQL DDL提供定义关系模式和视图、删除关系和视图、修改关系模 式的命令。
2. 交互式数据操纵语言。SQLDML提供查询、插入、删除和修改的命令。 
3. 事务控制(Transaction Control)。SQL提供定义事务开始和结束的命令。
4. 嵌入式SQL和动态SQL (Embeded SQL and Dynamic SQL)。用于嵌入到某种通用的高级语言(C、C++、Java、PL/I、COBOL和VB等)中混合编程。其中，SQL负责操纵数据 库，高级语言负责控制程序流程。
5. 完整性(Integrity)。 SQL DDL包括定义数据库中的数据必须满足的完整性约束条件 的命令，对于破坏完整性约束条件的更新将被禁止。
6. 权限管理(Authorization)。 SQL DDL中包括说明对关系和视图的访问权限。

### 9.4.3 SQL 数据定义

基本表和视图都是表，所不同的是基本表是实际存储在数据库中的表，视图是虚表，是从 基本表或其他视图中导出的表。

数据库中只存放视图的定义，不存放视图的数据。用户可用SQL 语句对基本表和视图进行査询等操作，在用户看来，基本表和视图一样，都是关系(即表)。



### 9.4.4 SQL 数据查询

### 9.4.5 SQL 数据更新

### 9.4.6 SQL 访问控制

### 9.4.7 嵌入式 SQL

## 9.5 关系数据库的规范化

### 9.5.1 函数依赖

### 9.5.2 规范化

### 9.5.3 模式分解及分解应具有的特性

## 9.6 数据库的控制功能

### 9.6.1 事务管理

### 9.6.2 数据库的备份与恢复

### 9.6.3 并发控制

